import sys,os


#testing module imports
import unittest
from unittest.mock import patch
from unittest.mock import MagicMock
import CppHeaderParser

from RoboteqCPPimporter import RoboteqCPPImporter


class CPPImportFixture(unittest.TestCase):

    def setUp(self):

        self.testHeader = open('test.h','w+')


        self.testHeader.write('#ifndef __Constants__\n#define __Constants__\n\n/******************** SetCommand Device ********************/\n#define _G 0\n#define _M 1\n#define _P 2\n#define _S 3\n#define _C 4\n#define _CB 5\n#define _VAR 6\n#define _AC 7\n#define _DC 8\n#define _DS 9\n#define _D1 10\n#define _D0 11\n#define _H 13\n#define _EX 14\n#define _MG 15\n#define _MS 16\n#define _PR 17\n#define _PX 18\n#define _PRX 19\n#define _AX 20\n#define _DX 21\n#define _B 22\n#define _SX 23\n#define _CS 24\n#define _RC 26\n#define _EES 27\n#define _BND 28\n#define _HS 35\n\n/******************** SetCommand Alias ********************/\n#define _GO 0\n#define _MOTCMD 1\n#define _MOTPOS 2\n#define _MOTVEL 3\n#define _SENCNTR 4\n#define _SBLCNTR 5\n#define _ACCEL 7\n#define _DECEL 8\n#define _DOUT 9\n#define _DSET 10\n#define _DRES 11\n#define _HOME 13\n#define _ESTOP 14\n#define _MGO 15\n#define _MSTOP 16\n#define _MPOSREL 17\n#define _NXTPOS 18\n#define _NXTPOSR 19\n#define _NXTACC 20\n#define _NXTDEC 21\n#define _BOOL 22\n#define _NXTVEL 23\n#define _CANSEND 24\n#define _RCOUT 26\n#define _EESAV 27\n#define _BIND 28\n\n/******************** GetValue Device ********************/\n#define _A 0\n#define _M 1\n#define _P 2\n#define _S 3\n#define _C 4\n#define _CB 5\n#define _VAR 6\n#define _SR 7\n#define _CR 8\n#define _BCR 9\n#define _BS 10\n#define _BSR 11\n#define _BA 12\n#define _V 13\n#define _D 14\n#define _DI 15\n#define _AI 16\n#define _PI 17\n#define _T 18\n#define _F 19\n#define _FS 20\n#define _FF 21\n#define _B 22\n#define _DO 23\n#define _E 24\n#define _CIS 25\n#define _CIA 26\n#define _CIP 27\n#define _TM 28\n#define _LK 29\n#define _TR 32\n#define _K 33\n#define _DR 34\n#define _AIC 35\n#define _PIC 36\n#define _MA 37\n#define _CL 38\n#define _CAN 39\n#define _CF 40\n#define _MGD 41\n#define _MGT 42\n#define _MGM 43\n#define _MGS 44\n#define _MGY 45\n#define _FM 48\n#define _HS_VALUE 49\n#define _ASI 51\n#define _ANG 65\n#define _SCC 69\n#define _ICL 70\n#define _FC 71\n#define _SL 72\n\n/******************** GetValue Alias ********************/\n#define _MOTAMPS 0\n#define _MOTCMD 1\n#define _MOTPWR 2\n#define _ABSPEED 3\n#define _ABCNTR 4\n#define _BLCNTR 5\n#define _RELSPEED 7\n#define _RELCNTR 8\n#define _BLRCNTR 9\n#define _BLSPEED 10\n#define _BLRSPEED 11\n#define _BATAMPS 12\n#define _VOLTS 13\n#define _DIGIN 14\n#define _DIN 15\n#define _ANAIN 16\n#define _PLSIN 17\n#define _TEMP 18\n#define _FEEDBK 19\n#define _STFLAG 20\n#define _FLTFLAG 21\n#define _BOOL 22\n#define _DIGOUT 23\n#define _LPERR 24\n#define _CMDSER 25\n#define _CMDANA 26\n#define _CMDPLS 27\n#define _TIME 28\n#define _LOCKED 29\n#define _TRACK 32\n#define _SPEKTRUM 33\n#define _DREACHED 34\n#define _ANAINC 35\n#define _PLSINC 36\n#define _MEMS 37\n#define _CALIVE 38\n#define _MGDET 41\n#define _MGTRACK 42\n#define _MGMRKR 43\n#define _MGSTATUS 44\n#define _MGYRO 45\n#define _MOTFLAG 48\n#define _HSENSE 49\n#define _RAWSENSADC 51\n#define _ANGLE 65\n\n/******************** SetConfig/GetConfig Alias ********************/\n#define _EE 0\n#define _BKD 1\n#define _OVL 2\n#define _UVL 3\n#define _THLD 4\n#define _MXMD 5\n#define _PWMF 6\n#define _CPRI 7\n#define _RWD 8\n#define _ECHOF 9\n#define _RSBR 10\n#define _ACS 11\n#define _AMS 12\n#define _CLIN 13\n#define _DFC 14\n#define _DINA 15\n#define _DINL 16\n#define _DOA 17\n#define _DOL 18\n#define _AMOD 19\n#define _AMIN 20\n#define _AMAX 21\n#define _ACTR 22\n#define _ADB 23\n#define _ALIN 24\n#define _AINA 25\n#define _AMINA 26\n#define _AMAXA 27\n#define _APOL 28\n#define _PMOD 29\n#define _PMIN 30\n#define _PMAX 31\n#define _PCTR 32\n#define _PDB 33\n#define _PLIN 34\n#define _PINA 35\n#define _PMINA 36\n#define _PMAXA 37\n#define _PPOL 38\n#define _MMOD 39\n#define _MXPF 40\n#define _MXPR 41\n#define _ALIM 42\n#define _ATRIG 43\n#define _ATGA 44\n#define _ATGD 45\n#define _KP 46\n#define _KI 47\n#define _KD 48\n#define _PIDM 49\n#define _ICAP 50\n#define _MAC 51\n#define _MDEC 52\n#define _MVEL 53\n#define _MXRPM 54\n#define _MXTRN 55\n#define _CLERD 56\n#define _BPOL 57\n#define _BLSTD 58\n#define _BLFB 59\n#define _BHOME 60\n#define _BLL 61\n#define _BHL 62\n#define _BLLA 63\n#define _BHLA 64\n#define _SPOL 65\n#define _OVH 66\n#define _ZAIC 67\n#define _ZPAO 68\n#define _ZPAC 69\n#define _ZSMC 70\n#define _EMOD 73\n#define _EPPR 74\n#define _ELL 75\n#define _EHL 76\n#define _ELLA 77\n#define _EHLA 78\n#define _EHOME 79\n#define _SKUSE 80\n#define _SKMIN 81\n#define _SKMAX 82\n#define _SKCTR 83\n#define _SKDB 84\n#define _SKLIN 85\n#define _CEN 86\n#define _CNOD 87\n#define _CBR 88\n#define _CHB 89\n#define _CAS 90\n#define _CLSN 91\n#define _CSRT 92\n#define _CTPS 93\n#define _SCRO 94\n#define _BMOD 95\n#define _BADJ 96\n#define _BADV 97\n#define _BZPW 98\n#define _BFBK 99\n#define _BEE 100\n#define _WMOD 103\n#define _IPA 104\n#define _GWA 105\n#define _SBM 106\n#define _IPP 107\n#define _MACA 108\n#define _HEOF 109\n#define _MDIR 119\n#define _KPF 141\n#define _KIF 142\n#define _TID 143\n#define _CTRIM 145\n#define _LEG 146\n#define _SSP 147\n#define _SST 148\n\n#endif\n')

        self.testHeader.close()
        self.referenceDict = dict()


        self.referenceDict = {'_G': '$00', '_M': '$01', '_P': '$02', '_S': '$03', '_C': '$04', '_CB': '$05', '_VAR': '$06', '_AC': '$07', '_DC': '$08', '_DS': '$09', '_D1': '$0a', '_D0': '$0b', '_H': '$0d', '_EX': '$0e', '_MG': '$0f', '_MS': '$10', '_PR': '$11', '_PX': '$12', '_PRX': '$13', '_AX': '$14', '_DX': '$15', '_B': '$16', '_SX': '$17', '_CS': '$18', '_RC': '$1a', '_EES': '$1b', '_BND': '$1c', '_HS': '$23', '_GO': '$00', '_MOTCMD': '$01', '_MOTPOS': '$02', '_MOTVEL': '$03', '_SENCNTR': '$04', '_SBLCNTR': '$05', '_ACCEL': '$07', '_DECEL': '$08', '_DOUT': '$09', '_DSET': '$0a', '_DRES': '$0b', '_HOME': '$0d', '_ESTOP': '$0e', '_MGO': '$0f', '_MSTOP': '$10', '_MPOSREL': '$11', '_NXTPOS': '$12', '_NXTPOSR': '$13', '_NXTACC': '$14', '_NXTDEC': '$15', '_BOOL': '$16', '_NXTVEL': '$17', '_CANSEND': '$18', '_RCOUT': '$1a', '_EESAV': '$1b', '_BIND': '$1c', '_A': '$00', '_SR': '$07', '_CR': '$08', '_BCR': '$09', '_BS': '$0a', '_BSR': '$0b', '_BA': '$0c', '_V': '$0d', '_D': '$0e', '_DI': '$0f', '_AI': '$10', '_PI': '$11', '_T': '$12', '_F': '$13', '_FS': '$14', '_FF': '$15', '_DO': '$17', '_E': '$18', '_CIS': '$19', '_CIA': '$1a', '_CIP': '$1b', '_TM': '$1c', '_LK': '$1d', '_TR': '$20', '_K': '$21', '_DR': '$22', '_AIC': '$23', '_PIC': '$24', '_MA': '$25', '_CL': '$26', '_CAN': '$27', '_CF': '$28', '_MGD': '$29', '_MGT': '$2a', '_MGM': '$2b', '_MGS': '$2c', '_MGY': '$2d', '_FM': '$30', '_HS_VALUE': '$31', '_ASI': '$33', '_ANG': '$41', '_SCC': '$45', '_ICL': '$46', '_FC': '$47', '_SL': '$48', '_MOTAMPS': '$00', '_MOTPWR': '$02', '_ABSPEED': '$03', '_ABCNTR': '$04', '_BLCNTR': '$05', '_RELSPEED': '$07', '_RELCNTR': '$08', '_BLRCNTR': '$09', '_BLSPEED': '$0a', '_BLRSPEED': '$0b', '_BATAMPS': '$0c', '_VOLTS': '$0d', '_DIGIN': '$0e', '_DIN': '$0f', '_ANAIN': '$10', '_PLSIN': '$11', '_TEMP': '$12', '_FEEDBK': '$13', '_STFLAG': '$14', '_FLTFLAG': '$15', '_DIGOUT': '$17', '_LPERR': '$18', '_CMDSER': '$19', '_CMDANA': '$1a', '_CMDPLS': '$1b', '_TIME': '$1c', '_LOCKED': '$1d', '_TRACK': '$20', '_SPEKTRUM': '$21', '_DREACHED': '$22', '_ANAINC': '$23', '_PLSINC': '$24', '_MEMS': '$25', '_CALIVE': '$26', '_MGDET': '$29', '_MGTRACK': '$2a', '_MGMRKR': '$2b', '_MGSTATUS': '$2c', '_MGYRO': '$2d', '_MOTFLAG': '$30', '_HSENSE': '$31', '_RAWSENSADC': '$33', '_ANGLE': '$41', '_EE': '$00', '_BKD': '$01', '_OVL': '$02', '_UVL': '$03', '_THLD': '$04', '_MXMD': '$05', '_PWMF': '$06', '_CPRI': '$07', '_RWD': '$08', '_ECHOF': '$09', '_RSBR': '$0a', '_ACS': '$0b', '_AMS': '$0c', '_CLIN': '$0d', '_DFC': '$0e', '_DINA': '$0f', '_DINL': '$10', '_DOA': '$11', '_DOL': '$12', '_AMOD': '$13', '_AMIN': '$14', '_AMAX': '$15', '_ACTR': '$16', '_ADB': '$17', '_ALIN': '$18', '_AINA': '$19', '_AMINA': '$1a', '_AMAXA': '$1b', '_APOL': '$1c', '_PMOD': '$1d', '_PMIN': '$1e', '_PMAX': '$1f', '_PCTR': '$20', '_PDB': '$21', '_PLIN': '$22', '_PINA': '$23', '_PMINA': '$24', '_PMAXA': '$25', '_PPOL': '$26', '_MMOD': '$27', '_MXPF': '$28', '_MXPR': '$29', '_ALIM': '$2a', '_ATRIG': '$2b', '_ATGA': '$2c', '_ATGD': '$2d', '_KP': '$2e', '_KI': '$2f', '_KD': '$30', '_PIDM': '$31', '_ICAP': '$32', '_MAC': '$33', '_MDEC': '$34', '_MVEL': '$35', '_MXRPM': '$36', '_MXTRN': '$37', '_CLERD': '$38', '_BPOL': '$39', '_BLSTD': '$3a', '_BLFB': '$3b', '_BHOME': '$3c', '_BLL': '$3d', '_BHL': '$3e', '_BLLA': '$3f', '_BHLA': '$40', '_SPOL': '$41', '_OVH': '$42', '_ZAIC': '$43', '_ZPAO': '$44', '_ZPAC': '$45', '_ZSMC': '$46', '_EMOD': '$49', '_EPPR': '$4a', '_ELL': '$4b', '_EHL': '$4c', '_ELLA': '$4d', '_EHLA': '$4e', '_EHOME': '$4f', '_SKUSE': '$50', '_SKMIN': '$51', '_SKMAX': '$52', '_SKCTR': '$53', '_SKDB': '$54', '_SKLIN': '$55', '_CEN': '$56', '_CNOD': '$57', '_CBR': '$58', '_CHB': '$59', '_CAS': '$5a', '_CLSN': '$5b', '_CSRT': '$5c', '_CTPS': '$5d', '_SCRO': '$5e', '_BMOD': '$5f', '_BADJ': '$60', '_BADV': '$61', '_BZPW': '$62', '_BFBK': '$63', '_BEE': '$64', '_WMOD': '$67', '_IPA': '$68', '_GWA': '$69', '_SBM': '$6a', '_IPP': '$6b', '_MACA': '$6c', '_HEOF': '$6d', '_MDIR': '$77', '_KPF': '$8d', '_KIF': '$8e', '_TID': '$8f', '_CTRIM': '$91', '_LEG': '$92', '_SSP': '$93', '_SST': '$94'}


        self.importer = RoboteqCPPImporter('test.h')

    def tearDown(self):

        os.remove('test.h')

    #def test_CPPImport(self):
    #    self.assertEqual(self.importer.generateCommandDict(), self.referenceDict)


    #def test_DirectImport(self):
    #    self.assertEqual(RoboteqCPPImporter.RoboteqImport('test.h'), self.referenceDict)

if __name__ == '__main__':
        unittest.main()
